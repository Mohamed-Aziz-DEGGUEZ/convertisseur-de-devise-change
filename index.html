<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mon Convertisseur de Devises</title>
    <style>
        :root {
            --bleu-fonce: #0a2a4c;
            --bleu-moyen: #007bff;
            --orange-princ: #ff6600;
            --orange-survol: #ff8533;
            --fond-clair: #f0f4f8;
            --texte-clair: #ffffff;
            --texte-sombre: #333;
            --bordure-clair: #ddd;
            --ombre-legere: 0 4px 10px rgba(0, 0, 0, 0.05);
            --ombre-moyenne: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--fond-clair);
            color: var(--texte-sombre);
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        header {
            background-color: var(--bleu-fonce);
            color: var(--texte-clair);
            padding: 1.5rem 2rem;
            box-shadow: var(--ombre-moyenne);
            position: relative;
            z-index: 1;
            width: 100%;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .titre-page {
            position: relative;
        }

        header h1 {
            margin: 0;
            font-size: 2.5rem;
            letter-spacing: 1px;
            text-transform: capitalize;
        }

        header h4 {
            margin-left: 0px;
            font-size: 0.5rem;
            letter-spacing: 1px;
            position: relative;
            top: -15px;
        }

        #bloc-devise-base {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        #bloc-devise-base label {
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--texte-clair);
        }

        #selecteur-devise-base {
            padding: 0.5rem;
            border-radius: 4px;
            border: 1px solid var(--bordure-clair);
            background-color: var(--texte-clair);
            color: var(--texte-sombre);
            font-weight: bold;
            font-size: 0.9rem;
        }

        .bloc-hero {
            position: relative;
            padding: 4rem 1.5rem;
            text-align: center;
            color: var(--texte-clair);
            overflow: hidden;
            min-height: 250px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .bloc-hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, var(--bleu-fonce) 20%, var(--orange-princ) 100%);
            background-size: cover;
            background-position: center;
            opacity: 1;
            transition: opacity 0.4s ease-out;
            z-index: 1;
        }

        .bloc-hero:hover::before {
            opacity: 0.5;
        }

        .contenu-hero {
            position: relative;
            z-index: 2;
            max-width: 600px;
        }

        .contenu-hero h2 {
            color: var(--texte-clair);
            font-size: 2.2rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
        }

        .contenu-hero p {
            font-size: 1.2rem;
            font-weight: 300;
        }

        main {
            flex: 1;
            max-width: 900px;
            width: 100%;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        .carte {
            background-color: var(--texte-clair);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: var(--ombre-legere);
            overflow: hidden;
        }

        h2.titre-section {
            color: var(--bleu-fonce);
            margin-bottom: 1.5rem;
            text-align: center;
            font-size: 1.8rem;
        }

        #section-conversion form {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
            align-items: flex-end;
        }

        @media (min-width: 768px) {
            #section-conversion form {
                grid-template-columns: 2fr 2fr 1fr 2fr;
            }
        }

        .champ-form {
            display: flex;
            flex-direction: column;
        }

        label {
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--bleu-fonce);
        }

        input[type="number"],
        select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--bordure-clair);
            border-radius: 4px;
            font-size: 1rem;
            background-color: #fcfcfc;
        }

        input[type="number"]:focus,
        select:focus {
            outline: 2px solid var(--orange-princ);
            border-color: transparent;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }

        .btn-principal {
            background-color: var(--orange-princ);
            color: var(--texte-clair);
            width: 100%;
            grid-column: 1 / -1;
        }

        .btn-principal:hover {
            background-color: var(--orange-survol);
            transform: translateY(-2px);
        }

        #btn-inverser {
            background-color: var(--texte-clair);
            color: var(--bleu-moyen);
            border: 1px solid var(--bordure-clair);
            font-size: 1.5rem;
            padding: 0.5rem;
            line-height: 1;
        }

        #btn-inverser:hover {
            background-color: #f4f4f4;
            transform: translateY(-2px);
            transition: background-color 0.3s ease, transform 0.4s ease;
        }

        #affichage-resultat {
            margin-top: 1.5rem;
            padding: 1rem;
            background-color: #e6f2ff;
            border-radius: 4px;
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--bleu-fonce);
            min-height: 2.5em;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.5s ease;
        }

        #affichage-resultat.chargement {
            animation: pulse 1.5s infinite ease-in-out;
        }

        .conteneur-tableau {
            overflow-x: auto;
        }

        #section-taux table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        #section-taux th,
        #section-taux td {
            padding: 0.75rem 1rem;
            text-align: left;
            border-bottom: 1px solid var(--bordure-clair);
        }

        #section-taux thead th {
            background-color: #e6f2ff;
            color: var(--bleu-fonce);
            font-size: 0.9rem;
            text-transform: uppercase;
        }

        #section-taux tbody tr:nth-child(even) {
            background-color: #f9f9f8;
        }

        #section-taux td:nth-child(2) {
            color: #d9534f;
            font-weight: 500;
        }

        #section-taux td:nth-child(4) {
            color: #5cb85c;
            font-weight: 500;
        }

        footer {
            background-color: var(--bleu-fonce);
            color: var(--texte-clair);
            padding: 2rem 1rem;
            margin-top: 2rem;
            text-align: center;
            width: 100%;
        }

        .contenu-pied {
            max-width: 900px;
            margin: 0 auto;
        }

        .contenu-pied h3 {
            color: var(--texte-clair);
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }

        .contenu-pied p {
            margin-bottom: 0.5rem;
            color: #f0f4f8;
            line-height: 1.5;
        }

        .contenu-pied a {
            color: var(--orange-princ);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .contenu-pied a:hover {
            color: var(--orange-survol);
            text-decoration: underline;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse {
            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.6;
            }
        }

        @media (max-width: 600px) {
            header {
                flex-direction: column;
                align-items: flex-start;
                padding: 1rem;
                min-height: 110px;
            }

            .titre-page {
                margin-bottom: 0.5rem;
                text-align: center;
                width: 100%;
            }

            header h1 {
                font-size: 2.5rem;
            }

            #bloc-devise-base {
                width: 100%;
                justify-content: flex-start;
            }

            #selecteur-devise-base {
                flex-grow: 1;
            }
        }
    </style>
</head>

<body>
    <header>
        <div class="titre-page">
            <h1>sarf</h1>
            <h4>le change près de chez vous</h4>
        </div>
        <div id="bloc-devise-base">
            <label for="selecteur-devise-base">Devise de base:</label>
            <select id="selecteur-devise-base"></select>
        </div>
    </header>

    <section class="bloc-hero">
        <div class="contenu-hero">
            <h2 class="head-hero">Votre Partenaire de Change de Confiance</h2>
            <p class="taux">Taux compétitifs et service instantané pour tous vos besoins en devises.</p>
        </div>
    </section>

    <main>
        <section id="section-conversion" class="carte">
            <h2 class="titre-section">Convertir des Devises</h2>
            <form id="form-conversion">
                <div class="champ-form">
                    <label for="montant">Montant</label>
                    <input type="number" id="montant" value="100" min="0" step="0.01">
                </div>

                <div class="champ-form">
                    <label for="devise-source">Devise Source</label>
                    <select id="devise-source"></select>
                </div>
                <div class="champ-form">
                    <label>&nbsp;</label>
                    <button type="button" id="btn-inverser" class="btn" aria-label="Inverser les devises">&leftrightarrow;</button>
                </div>
                <div class="champ-form">
                    <label for="devise-cible">Devise Destination</label>
                    <select id="devise-cible"></select>
                </div>

                <button type="submit" class="btn btn-principal">Convertir</button>
            </form>

            <div id="affichage-resultat">
                Saisissez un montant à convertir
            </div>
        </section>

        <section id="section-taux" class="carte">
            <h2 id="titre-tableau-taux" class="titre-section">Taux de Change</h2>

            <div class="conteneur-tableau">
                <table>
                    <thead>
                        <tr>
                            <th>Devise</th>
                            <th>Prix d'Achat</th>
                            <th>Taux International</th>
                            <th>Prix de Vente</th>
                        </tr>
                    </thead>
                    <tbody id="corps-tableau-taux">
                    </tbody>
                </table>
            </div>
        </section>
    </main>

    <footer>
        <div class="contenu-pied">
            <h3>Contactez-Nous</h3>
            <p>SARF S.A</p>
            <p>Siège social : Rue lac malaren, les berges du lac, Tunis</p>
            <p>Email: <a href="mailto:service-client@SARF">service-client@SARF</a></p>
            <p>Téléphone: +71 364 556</p>
            <p>Accord du BCT n°0233/2022</p>
        </div>
    </footer>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const API_URL = "https://api.frankfurter.app";
            const SPREAD = 0.01;
            const DEVISES_COURANTES = [
                'EUR', 'USD', 'JPY', 'GBP', 'AUD', 'CAD', 'CHF', 'CNY', 'HKD', 'NZD',
                'SEK', 'KRW', 'SGD', 'NOK', 'MXN', 'INR', 'RUB', 'ZAR', 'TRY', 'BRL',
                'DKK', 'PLN', 'THB', 'MYR'
            ];
            const MAP_NOM_PAYS = {
                'EUR': 'EURO',
                'USD': 'DOLLAR AMÉRICAIN',
                'GBP': 'LIVRE STERLING',
                'AUD': 'DOLLAR AUSTRALIEN',
                'CAD': 'DOLLAR CANADIEN',
                'CHF': 'FRANC SUISSE',
                'CNY': 'RENMINDI',
                'SGD': 'DOLLAR DE SINGAPOUR',
                'NOK': 'COURONNE NORVEGIENNE',
                'MXN': 'PESO MEXICAIN',
                'INR': 'ROUPIE INDIEN',
                'RUB': 'ROUBLE RUSSE',
                'ZAR': 'RAND',
                'TRY': 'LIVRE Turque',
                'BRL': 'REAL BRÉSILIEN',
                'DKK': 'COURONNE DANOISE',
                'PLN': 'ZOLTY',
                'THB': 'BAHT',
                'MYR': 'RINGGIT',
            };

            const formConversion = document.getElementById('form-conversion');
            const montantInput = document.getElementById('montant');
            const selectSource = document.getElementById('devise-source');
            const selectCible = document.getElementById('devise-cible');
            const btnInverser = document.getElementById('btn-inverser');
            const affichageResultat = document.getElementById('affichage-resultat');
            const corpsTableauTaux = document.getElementById('corps-tableau-taux');
            const titreTableauTaux = document.getElementById('titre-tableau-taux');
            const selecteurDeviseBase = document.getElementById('selecteur-devise-base');


            function remplirSelecteurs() {
                const lastFrom = localStorage.getItem('lastFrom' || 'USD');
                const lastTo = localStorage.getItem('lastTo' || 'EUR');

                DEVISES_COURANTES.forEach(devise => {
                    const nomPays = MAP_NOM_PAYS[devise] || devise;
                    const texteOption = `${nomPays} (${devise})`;

                    const optionSource = document.createElement('option');
                    optionSource.value = devise;
                    optionSource.textContent = texteOption;
                    selectSource.appendChild(optionSource);

                    const optionCible = document.createElement('option');
                    optionCible.value = devise;
                    optionCible.textContent = texteOption;
                    selectCible.appendChild(optionCible);

                    const optionBase = document.createElement('option');
                    optionBase.value = devise;
                    optionBase.textContent = texteOption;
                    selecteurDeviseBase.appendChild(optionBase);
                });

                selectSource.value = lastFrom;
                selectCible.value = lastTo;
                selecteurDeviseBase.value = lastFrom;
            }

            async function gererConversion(event) {
                event.preventDefault();

                const montant = parseFloat(montantInput.value);
                const deviseSource = selectSource.value;
                const deviseCible = selectCible.value;

                if (isNaN(montant) || montant <= 0) {
                    affichageResultat.textContent = "Veuillez entrer un montant valide.";
                    return;
                }

                affichageResultat.textContent = "Chargement...";
                affichageResultat.classList.add('chargement');

                if (deviseSource === deviseCible) {
                    affichageResultat.textContent = `${montant.toFixed(2)} ${deviseSource} = ${montant.toFixed(2)} ${deviseCible}`;
                 affichageResultat.classList.remove('chargement');
                    return;
                }

                try {
                    const reponse = await fetch(`${API_URL}/latest?amount=1&from=${deviseSource}&to=${deviseCible}`);
                    if (!reponse.ok) throw new Error("Erreur de réseau");

                    const donnees = await reponse.json();
                    const tauxInternational = donnees.rates[deviseCible];

                    const tauxVente = tauxInternational * (1 - SPREAD);
                    const montantConverti = montant * tauxVente;

                    affichageResultat.textContent = `${montant} ${deviseSource} = ${montantConverti.toFixed(2)} ${deviseCible} (Taux de vente appliqué)`;

                    localStorage.setItem('lastFrom', deviseSource);
                    localStorage.setItem('lastTo', deviseCible);

                } catch (erreur) {
                    console.error("Erreur de conversion:", erreur);
                    affichageResultat.textContent = "Erreur lors de la conversion.";
                } finally {
                    affichageResultat.classList.remove('chargement');
                }
            }

            function gererInversion() {
                const temp = selectSource.value;
                selectSource.value = selectCible.value;
                selectCible.value = temp;

                selectSource.dispatchEvent(new Event('change'));
            }

            async function chargerEtAfficherTableau(deviseBase) {
                titreTableauTaux.textContent = `Taux de Change (Base: ${deviseBase})`;
                corpsTableauTaux.innerHTML = `<tr><td colspan="4">Chargement des taux...</td></tr>`;

                const devisesCibles = DEVISES_COURANTES.filter(c => c !== deviseBase).join(',');

                try {
                    if (!devisesCibles) {
                        corpsTableauTaux.innerHTML = `<tr><td colspan="4">Devise de base sélectionnée.</td></tr>`;
                        return;
                    }
                    const reponse = await fetch(`${API_URL}/latest?from=${deviseBase}&to=${devisesCibles}`);
                    if (!reponse.ok) throw new Error(`Erreur de réseau (Devise ${deviseBase} non supportée)`);

                    const donnees = await reponse.json();
                    const taux = donnees.rates;
corpsTableauTaux.innerHTML = "";
DEVISES_COURANTES.forEach(devise => {
                        if (devise === deviseBase) return;
                        const tauxInternational = taux[devise];
                        if (!tauxInternational) return;

                        const prixAchat = tauxInternational * (1 + SPREAD);
                        const prixVente = tauxInternational * (1 - SPREAD);

                        const nomPays = MAP_NOM_PAYS[devise] || devise;
                        const tr = document.createElement('tr');
                        tr.innerHTML = `
                            <td><strong>${nomPays} (${devise})</strong></td>
                            <td>${prixAchat.toFixed(4)}</td>
                            <td>${tauxInternational.toFixed(4)}</td>
                            <td>${prixVente.toFixed(4)}</td>
                        `;
                        corpsTableauTaux.appendChild(tr);
                    });
                } catch (erreur) {
                    console.error("Erreur de tableau:", erreur);
                    corpsTableauTaux.innerHTML = `<tr><td colspan="4">Erreur: ${erreur.message}</td></tr>`;
                }
            }


            remplirSelecteurs();
            chargerEtAfficherTableau(selectSource.value);

            formConversion.addEventListener('submit', gererConversion);
            btnInverser.addEventListener('click', gererInversion);
selectSource.addEventListener('change', () => {
                const nouvelleBase = selectSource.value;
                selecteurDeviseBase.value = nouvelleBase;
                chargerEtAfficherTableau(nouvelleBase);
            }); selecteurDeviseBase.addEventListener('change', () => {
                const nouvelleBase = selecteurDeviseBase.value;
                selectSource.value = nouvelleBase;
selectSource.dispatchEvent(new Event('change'));
            });
        });
    </script>
</body>
</html>
